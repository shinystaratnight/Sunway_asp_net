var AutoComplete=new function(){var me=this;this.TextBox,this.AdditionalDropdownScripts="",this.Selected=!1,this.Timer,this.AutoSuggestKeyUp=function(e,t,o,s){if(iKeyCode=e.keyCode?e.keyCode:e.which,!(iKeyCode<41&&32!=iKeyCode&&8!=iKeyCode)){{f.GetObject(t.id+"Container")}if(t.value.length>2){this.Timer&&clearTimeout(this.Timer),s.SearchString=f.GetValue(t),s.TextBoxID=f.SafeObject(t).id;var i=JSON.stringify(s);this.Timer=setTimeout(function(){ff.Call(o,function(e){AutoComplete.AutoCompleteDisplayResults(e)},i)},300),AutoComplete.Selected=!1}else me.AutoSuggestClear(t)}},this.AutoSuggestKeyDown=function(e,t){iKeyCode=e.keyCode?e.keyCode:e.which;var o=document.getElementById(t.id+"Container"),s=document.getElementById(t.id+"Hidden");if("none"!=o.style.display)switch(iKeyCode){case 38:return void me.AutoSuggestMove(o,-1);case 40:return void me.AutoSuggestMove(o,0);case 33:return void me.AutoSuggestMove(o,-5);case 34:return void me.AutoSuggestMove(o,5);case 27:return void me.AutoSuggestHideContainer(o,!0);case 9:var i=me.AutoSuggestGetCurrentSelectedIndex(o);-1==i&&(i=0);var d=me.AutoSuggestGetCurrentSelectedID(o),l=me.AutoSuggestGetCurrentSelectedName(o);return void me.AutoCompleteSelect(o.id,t.id,d,l);case 13:var i=me.AutoSuggestGetCurrentSelectedIndex(o);-1==i&&(i=0);var d=me.AutoSuggestGetCurrentSelectedID(o),l=me.AutoSuggestGetCurrentSelectedName(o);return me.AutoCompleteSelect(o.id,t.id,d,l),!1;var n}},this.AutoCompleteDisplayResults=function(sJSON){if(!AutoComplete.Selected){var oResult=eval("("+sJSON+")"),sTextbox=oResult.TextBoxID,oContainer=f.GetObject(oResult.TextBoxID+"Container"),sDiv=oContainer.id,sHidden=sTextbox+"Hidden",oASTextbox=f.GetObject(sTextbox),sResult="",sText=oASTextbox.value;if(sText.length>2){for(var i=0;i<oResult.Items.length;i++){var sDisplay=oResult.Items[i].Display,sClass=i%2==0?"autoCompleteItem":"autoCompleteItem alternate",sDisplay=sDisplay.replace(new RegExp("("+sText+")","gi"),"<em>$1</em>"),sScript="AutoComplete.AutoCompleteSelect('"+oContainer.id+"','"+sTextbox+"',"+oResult.Items[i].Value+",'"+oResult.Items[i].Display+"');"+oResult.DropdownAdditionalScripts;sResult+='<div id="'+oResult.Items[i].Value+'" class="'+sClass+'" onclick="'+sScript+'" >'+sDisplay+"</div>"}oContainer.innerHTML=sResult,f.Show(oContainer)}else f.Hide(oContainer);f.RemoveClass(oASTextbox,"Working")}},this.AutoCompleteSelect=function(e,t,o,s){f.Hide(e),f.GetObject(t+"Hidden").value=o,f.GetObject(t).value=s},this.AutoSuggestClear=function(oTextbox,sAdditionalDropdownScripts){var oHidden=f.GetObject(oTextbox.id+"Hidden");oHidden.value="0",f.Hide(oTextbox.id+"Container"),void 0!=sAdditionalDropdownScripts&&null!=sAdditionalDropdownScripts&&eval(sAdditionalDropdownScripts)},this.AutoSuggestHideContainer=function(){},this.AutoSuggestMove=function(e,t){var o=e.childNodes.length-1,s=me.AutoSuggestGetCurrentSelectedIndex(e),i=s+t;0>i?i=0:i>o&&(i=o),me.AutoSuggestSetSelected(e,i,s)},this.AutoSuggestGetCurrentSelectedIndex=function(e){for(var t=0;t<e.childNodes.length;t++)if(f.HasClass(e.childNodes[t],"selected"))return t;return-1},this.AutoSuggestGetCurrentSelectedID=function(e){for(var t=0;t<e.childNodes.length;t++)if(f.HasClass(e.childNodes[t],"selected"))return e.childNodes[t].id;return-1},this.AutoSuggestGetCurrentSelectedName=function(e){for(var t=0;t<e.childNodes.length;t++)if(f.HasClass(e.childNodes[t],"selected"))return e.childNodes[t].innerText;return""},this.AutoSuggestSetSelected=function(e,t,o){o>-1&&f.RemoveClass(e.childNodes[o],"selected"),f.AddClass(e.childNodes[t],"selected"),e.childNodes[t].offsetTop<e.scrollTop?e.scrollTop=e.childNodes[t].offsetTop:e.childNodes[t].offsetTop>e.scrollTop+240&&(e.scrollTop=e.childNodes[t].offsetTop-240)}};
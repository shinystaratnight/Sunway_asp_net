var MyBookings=MyBookings||{};MyBookings.PropertyBookingReference="",MyBookings.ShowAmendmentPopup=function(t){MyBookings.PropertyBookingReference=t;var e=int.f.GetValue("hidAmendData_"+t);if(""!=e){var n=e.split("#");int.f.SetValue("txtHotelName",n[0]),document.getElementById("txtHotelName").disabled=!0,int.f.SetValue("txtDestination",n[3]),document.getElementById("txtDestination").disabled=!0;var i=new Date(n[1].substring(0,4),n[1].substring(5,7)-1,n[1].substring(8,10));int.f.SetValue("txtAmendmentDepartureDate",MyBookings.FormatDate(i)),document.getElementById("txtAmendmentDepartureDate").disabled=!0;var o=new Date(n[2].substring(0,4),n[2].substring(5,7)-1,n[2].substring(8,10));int.f.SetValue("txtAmendmentReturnDate",MyBookings.FormatDate(o)),document.getElementById("txtAmendmentReturnDate").disabled=!0}web.ModalPopup.Show("divAmendment",!0,"modalpopup container"),int.f.AttachEvent("divOverlay","click",function(){web.ModalPopup.Hide()})},MyBookings.FormatDate=function(t){var e=t.getMonth()+1;return 10>e&&(e="0"+e),t.getDate()+"/"+e+"/"+t.getFullYear()},MyBookings.RequestAmendmentValidate=function(){var t=int.f.GetValue("txtAmendmentDepartureDate"),e=int.f.GetValue("txtAmendmentReturnDate"),n=int.d.New(t.split("/")[0],t.split("/")[1],t.split("/")[2]),i=int.d.New(e.split("/")[0],e.split("/")[1],e.split("/")[2]),o=int.d.DateDiff(n,i);int.f.SetClassIf("txtAmendmentReturnDate","error",1>o),int.f.SetClassIf("txtAmendmentDepartureDate","error",!int.d.IsDate(n)||""==int.f.GetValue("txtAmendmentDepartureDate")),int.f.SetClassIf("txtAmendmentReturnDate","error",!int.d.IsDate(i)||""==int.f.GetValue("txtAmendmentReturnDate")||1>o);var a=int.f.GetElementsByClassName("*","error","divAmendment");0==a.length?(int.f.Hide("divAmendmentWarning"),int.f.Hide("divAmendmentForm"),int.f.Show("divAmendRequestWaitMessage"),int.ff.Call("Widgets.MyBookings.ADTRequestAmendment",function(t){MyBookings.RequestAmendmentComplete(t)},int.f.GetValue("hidBookingReference"),MyBookings.PropertyBookingReference,n,i,int.f.GetValue("txtDestination"),int.f.GetValue("txtHotelName"),int.f.GetValue("txtAdditionalInformation"))):int.f.Show("divAmendmentWarning")},MyBookings.RequestAmendmentComplete=function(t){"Success"==t?(int.f.Hide("divAmendRequestWaitMessage"),int.f.Hide("divAmendmentForm"),int.f.Show("divRequestSent")):(int.f.Hide("divAmendRequestWaitMessage"),int.f.Hide("divAmendmentForm"),int.f.Show("divRequestNotSent"))},MyBookings.SendDocumentation=function(){web.ModalPopup.Show("divEmailDocuments");var t=int.f.GetValue("hidBookingReference");int.ff.Call("Widgets.MyBookings.SendCustomerDocumentation",function(t){MyBookings.SendDocumentationDone(t)},t)},MyBookings.SendDocumentationDone=function(sJSON){var oReturn=eval("("+sJSON+")");1==oReturn.OK?(int.f.Hide("divEmailWaitMessage"),int.f.Show("divEmailSuccess"),setTimeout("web.ModalPopup.Hide()",2e3)):(web.ModalPopup.Hide(),web.InfoBox.Show("Sorry, there was a problem sending your documentation.","warning"))},MyBookings.ShowPaymentPopup=function(t){web.ModalPopup.Show("divPaymentDetails",!0,"modalpopup container"),int.f.AttachEvent("divOverlay","click",function(){web.ModalPopup.Hide()});var e=int.f.SafeObject("hidCSVTooltipText");if(e){var n=e.value,i=document.getElementById("aPayment_CSVTooltip");int.f.AttachEvent(i,"mouseover",function(){web.Tooltip.Show(i,n,"top",null,-50,0,"csvTooltip")}),int.f.AttachEvent(i,"mouseout",function(){web.Tooltip.Hide()})}},MyBookings.MakePayment=function(t){if(MyBookings.ValidatePayment(t)){int.f.Hide("divPaymentDetailsWarning"),int.f.Hide("divPaymentDetailsForm"),int.f.Show("divPaymentDetailsSending");var e=int.f.GetContainerQueryString("divPaymentDetails","hidCSVTooltipText");int.ff.Call("Widgets.MyBookings.MakePayment",function(t){MyBookings.MakePaymentComplete(t)},t,e)}else int.f.Show("divPaymentDetailsWarning")},MyBookings.ValidatePayment=function(t){for(var e=int.f.GetElementsByClassName("*","error",int.f.GetObject("divPaymentDetails")),n=0;n<e.length;n++)int.f.RemoveClass(e[n],"error");{var i=int.f.GetValue("txtCCCardNumber"),o=(int.f.GetIntValue("txtCCSecurityCode"),int.dd.GetValue("ddlCCExpireMonth")),a=int.dd.GetValue("ddlCCExpireYear"),d=int.f.GetValue("txtAmount");int.f.GetValue("txtAmountDueNow")}int.f.SetClassIf("ddlCCCardTypeID","error",0==int.dd.GetValue("ddlCCCardTypeID")),int.f.SetClassIf("txtCCCardNumber","error",!int.v.IsCardNumber(i)||""==i),int.f.SetClassIf("txtCCCardHoldersName","error",""==int.f.GetValue("txtCCCardHoldersName")),int.f.SetClassIf("ddlCCExpireMonth","error",""==o||!int.v.IsNumeric(o)),int.f.SetClassIf("ddlCCExpireYear","error",""==a||!int.v.IsNumeric(a)),int.f.SetClassIf("txtCCSecurityCode","error",""==int.f.GetValue("txtCCSecurityCode")),int.f.SetClassIf("txtAmount","error",0==int.n.SafeNumeric(d));var r=int.f.GetElementsByClassName("","error","divPaymentDetails").length;return r>0?!1:!0},MyBookings.MakePaymentComplete=function(t){t?(int.f.Hide("divPaymentDetailsSending"),int.f.Show("divPaymentDetailsSent")):(int.f.Hide("divPaymentDetailsSending"),int.f.Show("divPaymentDetailsNotSent"))},MyBookings.LogOut=function(){var t="/booking-login";""!=int.f.GetValue("hidLogoutRedirectURL")&&(t=int.f.GetValue("hidLogoutRedirectURL")),int.ff.Call("=iVectorWidgets.MyBookings.LogOut",function(){window.location=t})},MyBookings.CreditCardSelect=function(){int.dd.GetValue("ddlCCCardTypeID")},MyBookings.ShowApisPopup=function(){return web.JQueryModalPopup.Show("divADTAPISWrapper",!0,"container"),!1},MyBookings.Setup=function(){int.f.GetObject("hidPaymentSuccessful")&&web.InfoBox.Show(int.f.GetValue("hidPaymentSuccessText"),"success");var t=document.getElementById("aLogOut");null!=t&&int.f.AttachEvent("aLogOut","click",function(){MyBookings.LogOut()});var e=document.getElementById("btnShowApis");null!=e&&int.f.AttachEvent("btnShowApis","click",function(){MyBookings.ShowApisPopup()});var n=document.getElementById("btnPayBalanceShow");null!=n&&int.f.AttachEvent("btnPayBalanceShow","click",function(){OffsitePaymentRedirect.GetOffsitePaymentURL()}),int.f.AttachEvent("aSendDocumentation","click",function(){MyBookings.SendDocumentation()})},$(document).ready(function(){MyBookings.Setup()});
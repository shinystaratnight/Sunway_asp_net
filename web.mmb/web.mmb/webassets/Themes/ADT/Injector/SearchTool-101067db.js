var ADT_SearchTool=new function(){this.Setup=function(){$("input:radio[name=ADT-ComboSelector]").bind("click",function(){ADT_SearchTool.Show()}),$("#ADT-BookLeaving-FH").bind("change",function(){ADT_SearchTool.DestinationDropdowns()}),$("#ADT-BookDestinationCountry-FH").bind("change",function(){ADT_SearchTool.DestinationDropdowns()}),ADT_SearchTool.AttachDatePickers(),$(".ADT-RemoveRoom").bind("click",function(){ADT_SearchTool.RemoveRoom()}),$("#ADT-AddRoom").bind("click",function(){ADT_SearchTool.AddRoom()}),$("#ADT-BookChildNumber1-FH").bind("change",function(){ADT_SearchTool.ShowChildAges()}),$("#ADT-BookChildNumber2-FH").bind("change",function(){ADT_SearchTool.ShowChildAges()}),$("#ADT-BookChildNumber3-FH").bind("change",function(){ADT_SearchTool.ShowChildAges()}),$("#ADT-SearchFlightsAndHotels").bind("click",function(){ADT_SearchTool.Validate()}),$("#ADT-BookOneWayFlights-FH").bind("click",function(){ADT_SearchTool.SelectOneWay()}),ADT_SearchTool.Show()},this.Show=function(){var o=$("input:radio[name=ADT-ComboSelector]:checked").val();$(".ADT-BookDirectFlights").toggle("flightplushotel"==o||"flight"==o),$("#ADT-AddRoom").toggle("flightplushotel"==o||"hotel"==o),$(".ADT-BookLeaving").toggle("flightplushotel"==o||"flight"==o),$(".ADT-BookDirectFlights").toggle("flightplushotel"==o||"flight"==o),$("#ADT-AddRoom").toggle("flightplushotel"==o||"hotel"==o),$(".ADT-BookOneWayFlights").toggle("flight"==o),$(".ADT-BookDestination").toggle("flightplushotel"==o||"hotel"==o),$(".ADT-BookDestinationResort").toggle("flightplushotel"==o||"hotel"==o),$(".ADT-BookDestinationAirport").toggle("flight"==o),ADT_SearchTool.SelectOneWay(),ADT_SearchTool.ConfigureRooms();var e=$("#hidDefaultAirportID").val();$("#ADT-BookLeaving-FH").val(e);var t=$("#hidDefaultDestinationID").val();ADT_SearchTool.DestinationDropdowns(t),ADT_SearchTool.ShowChildAges()},this.ShowChildAges=function(){var o=parseInt($("#ADT-RoomCount").val()),e=$("#ADT-BookChildNumber1-FH").val();$("#ADT_ChildAges_Room1").toggle(e>0);for(var t=1;6>=t;t++)$("#ADT_ChildAges_Room1_"+t+"_Age").toggle(e>=t);var a=$("#ADT-BookChildNumber2-FH").val();$("#ADT_ChildAges_Room2").toggle(a>0&&o>1);for(var i=1;6>=i;i++)$("#ADT_ChildAges_Room2_"+i+"_Age").toggle(a>=i);var n=$("#ADT-BookChildNumber3-FH").val();$("#ADT_ChildAges_Room3").toggle(n>0&&o>2);for(var r=1;6>=r;r++)$("#ADT_ChildAges_Room3_"+r+"_Age").toggle(n>=r)},this.SelectOneWay=function(){var o=$("#ADT-BookOneWayFlights-FH").is(":checked"),e=$("input:radio[name=ADT-ComboSelector]:checked").val();$(".ADT-BookDateReturning").toggle(0==o||"flight"!=e)},this.Validate=function(){{var o=$("input:radio[name=ADT-ComboSelector]:checked").val(),e=parseInt($("#ADT-BookLeaving-FH").val()),t=parseInt($("#ADT-BookDestinationCountry-FH").val()),a=parseInt($("#ADT-BookDestinationResort-FH").val()),i=parseInt($("#ADT-BookDestinationAirport-F").val()),n=$("#ADT-BookDateLeaving-FH").datepicker("getDate");$("#ADT-BookDateReturning-FH").datepicker("getDate")}if($("#ADT-BookLeaving-FH").toggleClass("ADT-error",0==e||isNaN(e)),$("#ADT-BookDestinationCountry-FH").toggleClass("ADT-error",("flightplushotel"==o||"hotel"==o)&&(0==t||isNaN(t))),$("#ADT-BookDestinationAirport-F").toggleClass("ADT-error","flight"==o&&(0==i||isNaN(i))),0==$(".ADT-error").length){var r=$("#ADTBaseURL").val();r=r.replace("http","https");var l=r+"search?mode="+o;("flightplushotel"==o||"flight"==o)&&(l+="&airport="+e,l+="&direct="+$("#ADT-BookDirectFlights-FH").is(":checked")),"flight"==o&&(l+="&oneway="+$("#ADT-BookOneWayFlights-FH").is(":checked")),t>0&&(l+="&region="+t),a>0&&(l+="&resort="+a),i>0&&(l+="&arrivalairport="+i),l+="&depdate="+$.datepicker.formatDate("yy-mm-dd",n),l+="&nights="+$("#ADTDuration").val();var D=parseInt($("#ADT-BookChildNumber1-FH").val());l+="&adults="+$("#ADT-BookAdultNumber1-FH").val(),l+="&children="+D,l+="&infants="+$("#ADT-BookInfantNumber1-FH").val();for(var A=0,h=1;D>=h;h++)1==h&&(l+="&childages="),A=$("#ADT_ChildAges_Room1_"+h+"_Age").val(),l+=A,D>h&&(l+=",");for(var T=$("#ADT-RoomCount").val(),h=2;T>=h;h++){D=$("#ADT-BookChildNumber"+h+"-FH").val(),l+="&room"+h+"=",l+=$("#ADT-BookAdultNumber"+h+"-FH").val(),l+=","+D,l+=","+$("#ADT-BookInfantNumber"+h+"-FH").val();for(var s=1;D>=s;s++)1==s&&(l+="|"),A=$("#ADT_ChildAges_Room"+h+"_"+s+"_Age").val(),l+=A,D>s&&(l+=",")}window.top.location.href=l}},this.AttachDatePickers=function(){var o=$("#ADTDateFormat").val(),e=$("#ADTMinDate").val(),t=$("#ADTMaxDate").val(),a=$.datepicker.parseDate(o,e),i=$.datepicker.parseDate(o,t),n=parseInt($("#ADTDuration").val());$("#ADT-BookDateLeaving-FH").datepicker({dateFormat:o,changeMonth:!0,changeYear:!0,minDate:a,maxDate:i,defaultDate:a,onSelect:function(){setTimeout(function(){$("#ADT-BookDateReturning-FH").datepicker("option","minDate",$("#ADT-BookDateLeaving-FH").datepicker("getDate"))},200)},constrainInput:!0});var r=$.datepicker.parseDate(o,e);r.setDate(r.getDate()+n),$("#ADT-BookDateReturning-FH").datepicker({dateFormat:o,changeMonth:!0,changeYear:!0,minDate:a,maxDate:i,defaultDate:r,onSelect:function(){ADT_SearchTool.UpdateDuration()}})},this.UpdateDuration=function(){var o=$("#ADT-BookDateLeaving-FH").datepicker("getDate"),e=$("#ADT-BookDateReturning-FH").datepicker("getDate"),t=parseInt((e-o)/864e5);$("#ADTDuration").val(t)},this.UpdateReturnDate=function(){var o=$("#ADT-BookDateLeaving-FH").datepicker("getDate"),e=parseInt($("#ADTDuration").val()),t=o.getFullYear(),a=o.getMonth(),i=o.getDate(),n=new Date(t,a,i);n.setDate(n.getDate()+parseInt(e)),$("#ADT-BookDateReturning-FH").datepicker("option","minDate",o),$("#ADT-BookDateReturning-FH").datepicker("setDate",n)},this.AddRoom=function(){var o=parseInt($("#ADT-RoomCount").val());$("#ADT-RoomCount").val(o+1),ADT_SearchTool.ConfigureRooms()},this.RemoveRoom=function(){var o=parseInt($("#ADT-RoomCount").val());$("#ADT-RoomCount").val(o-1),ADT_SearchTool.ConfigureRooms()},this.ConfigureRooms=function(){var o,e=$("input:radio[name=ADT-ComboSelector]:checked").val();"flight"==e?($("#ADT-RoomCount").val(1),o=$("#ADT-RoomCount").val()):o=$("#ADT-RoomCount").val();for(var t=1;3>=t;t++){var a="#ADT-BookRoom"+t+"-FH",i="#ADT-BookRoomLabel"+t+"-FH";$(a).toggle(o>=t),$(i).toggle(o>=t&&("flightplushotel"==e||"hotel"==e))}$(".ADT-AddRoomLink").toggle(3>o),ADT_SearchTool.ShowChildAges()},this.DestinationDropdowns=function(o){var e=$("#ADTBaseURL").val();e=e.replace("http","https");var t=$("input:radio[name=ADT-ComboSelector]:checked").val(),a=parseInt($("#ADT-BookDestinationCountry-FH").val()),i=parseInt($("#ADT-BookLeaving-FH").val());o>0&&(a=o),"flight"==t?$.getJSON(e+"injector/search/index/destinationairport/"+i+"?callback=?",function(o){ADT_SearchTool.DestinationAirportDropdownsComplete(o)}):$.getJSON(e+"injector/search/index/destinations/"+a+"/"+i+"?callback=?",function(o){ADT_SearchTool.DestinationDropdownsComplete(o)})},this.DestinationDropdownsComplete=function(o){$(".ADT-BookDestination").html(o.RegionDropdown),$(".ADT-BookDestinationResort").html(o.ResortDropdown),$("#ADT-BookDestinationCountry-FH").bind("change",function(){ADT_SearchTool.DestinationDropdowns(0)})},this.DestinationAirportDropdownsComplete=function(o){$(".ADT-BookDestinationAirport").html(o.AirportDropdown);var e=$("#hidDefaultArrivialAirportID").val();o.DestinationID>0?$("#ADT-BookDestinationAirport-F").val(o.DestinationID):e>0&&$("#ADT-BookDestinationAirport-F").val(e)}};
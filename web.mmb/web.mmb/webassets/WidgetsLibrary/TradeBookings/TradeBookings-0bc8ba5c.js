var TradeBookings=TradeBookings||{};TradeBookings.CurrentPage=1,TradeBookings.PreviousPage=function(){TradeBookings.UpdateResults(TradeBookings.CurrentPage-1)},TradeBookings.NextPage=function(){TradeBookings.UpdateResults(TradeBookings.CurrentPage+1)},TradeBookings.SelectPage=function(n){TradeBookings.UpdateResults(n)},TradeBookings.Sort=function(n,e,o){int.ff.Call("=iVectorWidgets.TradeBookings.SortBookings",function(n){TradeBookings.UpdateResults(n)},n,e),aSortLinks=int.f.GetElementsByClassName("a","sort","divTradeBookings");for(var t=0;t<aSortLinks.length;t++)int.f.RemoveClass(aSortLinks[t],"selected");int.f.AddClass(o,"selected")},TradeBookings.UpdateResults=function(n){TradeBookings.CurrentPage=n||1,int.ff.Call("=iVectorWidgets.TradeBookings.UpdateResults",TradeBookings.UpdateResultsComplete,TradeBookings.CurrentPage)},TradeBookings.UpdateResultsComplete=function(n){try{var e=JSON.parse(n);int.f.SetHTML("divBookingsTable",e.TradeBookingsHTML),int.f.SetHTML("divTradeBookingsFooter",e.PagingHTML+'<div class="clear"></div>'),int.e.ScrollIntoView("divFindBooking",-1*int.e.GetPosition("divFindBooking").Height,2)}catch(o){web.InfoBox.Show("Sorry, there was an unexpected error","warning")}},TradeBookings.ViewDocuments=function(n,e){web.ModalPopup.Show("divDocumentationWaitMessage",!0),int.ff.Call("=iVectorWidgets.TradeBookings.GetDocumentation",function(n){TradeBookings.ViewDocumentationDone(n)},n,e)},TradeBookings.ViewDocumentationDone=function(n){var e=JSON.parse(n);if(int.f.Hide("divDocumentationWaitMessage"),web.ModalPopup.Hide(),e.ReturnStatus.Success&&e.DocumentPaths.length>0)for(var o=0;o<e.DocumentPaths.length;o++)window.open(e.DocumentPaths[o],"documentation"+o,"toolbar=no,location=no,menubar=no,copyhistory=no,status=no,directories=no");else web.InfoBox.Show(int.f.GetValue("hidTradeBookings_ErrorNoDocuments"),"warning")},TradeBookings.GetSendDocumentationPopup=function(n){int.ff.Call("=iVectorWidgets.TradeBookings.GetSendDocumentationPopupContent",function(n){TradeBookings.GetSendDocumentationPopupDone(n)},n)},TradeBookings.GetSendDocumentationPopupDone=function(n){web.ModalPopup.Show(n,!0,"modalpopup tradeEmailDocs")},TradeBookings.SendDocumentation=function(n,e){int.ff.Call("=iVectorWidgets.TradeBookings.SendDocumentation",function(n){TradeBookings.SendDocumentationDone(n)},n,e,int.f.GetValue("txtOverrideEmail"))},TradeBookings.SendDocumentationDone=function(sJSON){var oReturn=eval("("+sJSON+")");int.f.Hide("divSendDocumentationForm"),int.f.Show(oReturn.ReturnStatus.Success?"pEmailDocumentationRequestThankyou":"pEmailDocumentationRequestError")},TradeBookings.ComponentCancellation_GetPopup=function(n){int.ff.Call("=iVectorWidgets.TradeBookings.GetCancellationPopupDetails",function(n){TradeBookings.ComponentCancellation_GetPopupDone(n)},n)},TradeBookings.ComponentCancellation_GetPopupDone=function(n){web.ModalPopup.Show(n,!0,"modalpopup tradeCancelComponent")},TradeBookings.ComponentCancellation_SelectComponent=function(n){var e=0,o=int.f.GetObjectsByIDPrefix("chkCancelComponent_","input");if(int.cb.Checked(n)&&"All"==n.id.split("_")[1]){for(e=0;e<o.length;e++)int.cb.SetValue(o[e],!1);int.cb.SetValue(n,!0)}else int.cb.Checked(n)&&int.cb.SetValue(int.f.GetObjectsByIDPrefix("chkCancelComponent_All","input")[0],!1);var t=0,i=!1;for(e=0;e<o.length;e++){var a=o[e].id.split("_");int.cb.Checked(o[e])&&(t+=int.n.SafeNumeric(int.f.GetValue("hidCancelComponent_"+a[1]+"_"+a[2]+"_"+a[3])),i=!0)}int.f.SetHTML("spCancelComponent_Total",i?int.f.GetValue("hidCancelComponent_SellingCurrencySymbol")+t:""),int.f.SetValue("hidCancelComponent_Total",i?t:0)},TradeBookings.ComponentCancellation_CancelComponent=function(){int.f.Hide("pCancellationRequestNoComponents");var n=int.f.GetValue("hidCancelComponent_BookingReference");if(int.cb.Checked(int.f.GetObjectsByIDPrefix("chkCancelComponent_All","input")[0]))TradeBookings.CancelBooking(n,int.f.GetValue("hidCancelComponent_Total"),int.f.GetObjectsByIDPrefix("chkCancelComponent_All","input")[0].id.split("_")[2]);else{var e=0,o=int.f.GetObjectsByIDPrefix("chkCancelComponent_","input"),t={BookingReference:n,BookingComponents:new Array},i=!1;for(e=0;e<o.length;e++){var a=o[e].id.split("_");if(int.cb.Checked(o[e])&&"All"!=a[1]){i=!0;var s={ComponentBookingID:a[3],ComponentType:a[1],CancellationCost:int.n.SafeNumeric(int.f.GetValue("hidCancelComponent_"+a[1]+"_"+a[2]+"_"+a[3])),CancellationToken:a[2]};t.BookingComponents.push(s)}}i?int.ff.Call("=iVectorWidgets.TradeBookings.CancelComponents",TradeBookings.CancelBookingDone,JSON.stringify(t)):int.f.Show("pCancellationRequestNoComponents")}},TradeBookings.CancelBooking=function(n,e,o){int.ff.Call("=iVectorWidgets.TradeBookings.RequestCancellation",function(n){TradeBookings.CancelBookingDone(n)},n,e,o)},TradeBookings.CancelBookingDone=function(n){int.f.Hide("pCancellationRequestAsk"),int.f.Hide("pCancellationRequestButton"),int.f.Hide("pCancellationRequestNoComponents"),int.f.Hide("tblCancelComponent"),int.f.ShowIf("pCancellationRequestThankyou","true"==n),int.f.ShowIf("pCancellationRequestError","true"!=n),window.location.reload()};